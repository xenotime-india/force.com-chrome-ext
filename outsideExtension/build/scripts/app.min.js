var apiVersion="41.0",requestMetadata=[],requestSqlData=[{type:"ApexClass",table:"ApexClass_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"ApexPage",table:"ApexPage_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"ApexTrigger",table:"ApexTrigger_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"ApexComponent",table:"ApexComponent_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"StaticResource",table:"StaticResource_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"WebLink",table:"WebLink_tb",soqlFields:"Id, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate, PageOrSobjectType",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","PageOrSobjectType","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:[3,2]},{type:"Dashboard",table:"Dashboard_tb",soqlFields:"Id, Title, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Title","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:2},{type:"Report",table:"Report_tb",soqlFields:"Id, Name, DeveloperName,LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","Name","DeveloperName","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:3},{type:"RecordType",table:"RecordType_tb",soqlFields:"Id, SobjectType, Name, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate, DeveloperName",soqlWhere:"NamespacePrefix = null",fields:["Select","Id","SobjectType","Name","DeveloperName","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:[2,4]},{type:"ActionLinkGroupTemplate",table:"ActionLinkGroupTemplate_tb",soqlFields:"Id, MasterLabel, DeveloperName, LastModifiedDate, LastModifiedBy.Name, CreatedBy.Name, CreatedDate",soqlWhere:"Id != null",fields:["Select","Id","MasterLabel","DeveloperName","LastModifiedDate","LastModifiedBy","CreatedDate","CreatedBy"],apiFieldIndex:3}];function __getCookie(e){var a,t,r,i=document.cookie.split(";");for(a=0;a<i.length;a++)if(t=i[a].substr(0,i[a].indexOf("=")),r=i[a].substr(i[a].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))==e)return unescape(r)}var filterBy="LastModifiedDate",filterByMetadata="lastModifiedDate",sforce=new jsforce.Connection({serverUrl:getServerURL(),sessionId:__getCookie("sid")});function changefilterMode(e,a){filterBy=e,filterByMetadata=a}function getServerURL(){var e=window.location.href.split("/");return e[0]+"//"+e[2]}var blobToBase64=function(e,a){var t=new FileReader;t.onload=function(){var e=t.result.split(",")[1];a(e)},t.readAsDataURL(e)};function addRow(e,a,t){jQuery(t).append("<tr/>"),a.map(function(a){return"Select"==a?jQuery('<td><i class="fa fa-square-o"></i></td>'):"null"==e[a]||null==e[a]?jQuery("<td></td>"):isDate(e[a])?jQuery("<td>"+showDate(e[a])+"<br/>("+moment(new Date(e[a])).fromNow()+")</td>"):"string"==typeof e[a]?jQuery("<td>"+e[a]+"</td>"):jQuery("<td>"+e[a].Name+"</td>")}).forEach(function(e){jQuery(t).find("tr:last").append(e)})}function isDate(e){var a=new Date(e);return!isNaN(a.valueOf())}function showDate(e){var a=new Date(e),t=a.getFullYear(),r=a.getMonth()+1,i=a.getDate();return r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i}function createPanel(e,a,t){jQuery(t).append('<li><a href="#'+jQuery(a).attr("Id")+'-tab" role="tab" data-toggle="tab">'+e+"</a></li>");var r=jQuery('<div class="tab-pane" id="'+jQuery(a).attr("Id")+'-tab"/>'),i=jQuery('<div class="panel panel-default"/>');return jQuery(i).append('<div class="panel-heading"> '+e+"</div>"),jQuery(i).append('<div class="panel-body"></div>'),jQuery(i).find(".panel-body").append(jQuery(a)),jQuery(r).append(jQuery(i)),jQuery(r)}function createTable(e,a){var t=jQuery('<table id="'+a+'" cellpadding="0" border="0" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>');for(jQuery(t).append("<thead></thead>"),jQuery(t).append("<tbody></tbody>"),jQuery(t).find("thead").append("<tr/>"),i=0;i<e.length;i++)"Select"==e[i]?jQuery(t).find("tr:last").append('<td><input type="checkbox" onclick="selectAll(this,\''+a+"','')\"/></td>"):jQuery(t).find("thead>tr").append("<th>"+e[i]+"</th>");return jQuery(t)}function selectAll(e,a,t){var r=(""!=a?jQuery("#"+a).dataTable():jQuery(t).dataTable()).fnGetNodes();jQuery(r).each(function(){""==e||jQuery(e).is(":checked")?(jQuery(this).addClass("selected"),jQuery(this).find("i.fa").removeClass("fa-square-o").addClass("fa-check-square-o")):(jQuery(this).removeClass("selected"),jQuery(this).find("i.fa").removeClass("fa-check-square-o").addClass("fa-square-o"))})}function globalSelectAll(){requestMetadata.forEach(function(e,a){selectAll("","",jQuery("#"+e.table))}),requestSqlData.forEach(function(e,a){selectAll("","",jQuery("#"+e.table))})}function globalUnSelectAll(){requestMetadata.forEach(function(e,a){selectAll(" ","",jQuery("#"+e.table))}),requestSqlData.forEach(function(e,a){selectAll(" ","",jQuery("#"+e.table))})}function waitForDone(e){function a(t){var r;t[0].getBoolean("done")?(r=t[0].id,sforce.metadata.checkRetrieveStatus(r,e)):sforce.metadata.checkStatus([t[0].id],a)}return function(e){a([e])}}function maketypeblock(e,a,t){var r="";return jQuery(e).DataTable().rows(".selected").data().length>0&&(r+="\n    <types>",jQuery(jQuery(e).DataTable().rows(".selected").data()).each(function(){jQuery(this);if(r+="\n        <members>","number"==typeof a)""!=jQuery(this)[a]&&"null"!=jQuery(this)[a]&&null!=jQuery(this)[a]&&(r+=jQuery(this)[a]);else for(i=0;i<a.length;i++)""!=jQuery(this)[a[i]]&&"null"!=jQuery(this)[a[i]]&&null!=jQuery(this)[a[i]]&&(i!=a.length-1?r+=jQuery(this)[a[i]]+".":r+=jQuery(this)[a[i]]);r+="</members>"}),r+=" \n       <name>"+t+"</name>",r+=" \n   </types>"),r}function makeobjectToRetrive(e,a,t){var r;return jQuery(e).DataTable().rows(".selected").data().length>0&&(r={name:t,members:[]},jQuery(jQuery(e).DataTable().rows(".selected").data()).each(function(){if("number"==typeof a)""!=jQuery(this)[a]&&"null"!=jQuery(this)[a]&&null!=jQuery(this)[a]&&r.members.push(jQuery(this)[a]);else for(i=0;i<a.length;i++){var e="";""!=jQuery(this)[a[i]]&&"null"!=jQuery(this)[a[i]]&&null!=jQuery(this)[a[i]]&&(i!=a.length-1?e+=jQuery(this)[a[i]]+".":e+=jQuery(this)[a[i]]),r.members.push(e)}})),r}function getPackage(){showLoading();var e=[];requestMetadata.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)}),requestSqlData.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)}),e.length>0?sforce.metadata.retrieve({unpackaged:{types:e,version:apiVersion}}).complete(function(e,a){location.href="data:application/zip;base64,"+a.zipFile,hideLoading()}):hideLoading()}function deploy(){}function createChangeSet(){var e=[];requestMetadata.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)}),requestSqlData.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)}),localStorage.setItem("changeSet",JSON.stringify(e))}function loginUser(){var e=[];requestMetadata.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)}),requestSqlData.forEach(function(a,t){var r=makeobjectToRetrive(jQuery("#"+a.table),a.apiFieldIndex,a.type);void 0!==r&&e.push(r)});sforce.metadata.retrieve({unpackaged:{types:e,version:apiVersion}}).complete(function(e,a){var t=new Blob([a.zipFile],{type:"application/zip"});blobToBase64(t,function(e){var a=new File([e],"package.zip",{type:"application/zip"}),t=new FormData;t.append("file",a),fetch("http://localhost:3000/upload",{method:"POST",body:t}).then(function(e){return e.json()}).then(console.log).catch(console.error)})})}function generateXml(){var e='<?xml version="1.0" encoding="UTF-8"?>';e+='\n<Package xmlns="http://soap.sforce.com/2006/04/metadata">',requestMetadata.forEach(function(a,t){e+=maketypeblock(jQuery("#"+a.table),a.apiFieldIndex,a.type)}),requestSqlData.forEach(function(a,t){e+=maketypeblock(jQuery("#"+a.table),a.apiFieldIndex,a.type)}),e+="\n    <version>"+apiVersion+"</version>\n</Package>",jQuery("#xmlData").val(e),jQuery("#xmlDialog").modal()}function updateData(){showLoading(),setTimeout(function(){jQuery("#container").html(""),jQuery("#container-tab2").html(""),jQuery("#container-tab").html(""),workWithSOQL().then(function(){return workWithSessionStorageMetaData()}).then(function(){jQuery('#myTab a[href="#'+requestSqlData[0].type+'_tb-tab"]').tab("show"),hideLoading()}).catch(function(e){})},200)}function workWithSOQL(){var e="2015-12-10";""!=jQuery("#dateField").val()&&(e=convertDate(jQuery("#dateField").val()));var a=requestSqlData.map(function(a){var t="Select "+a.soqlFields+" From "+a.type+" where ";return t+=""!=e?filterBy+" >= "+e+" AND ":"",t+=" "+a.soqlWhere+" order by "+filterBy+" desc",sforce.query(t)});return Promise.all(a).then(function(e){return e.forEach(function(e,a){var t=e.records;if(t&&t.length>0){var r,i;i=createTable(requestSqlData[a].fields,requestSqlData[a].table),r=createPanel(requestSqlData[a].type,i,jQuery("#container-tab"));for(var d=0;d<t.length;d++)addRow(t[d],requestSqlData[a].fields,jQuery(i).find("tbody"));jQuery("#container").append(jQuery(r)),jQuery("#"+requestSqlData[a].table).DataTable({order:[[requestSqlData[a].fields.indexOf("LastModifiedDate"),"desc"]],iDisplayLength:100}),jQuery("#"+requestSqlData[a].table+" tbody").on("click","tr",function(){jQuery(this).toggleClass("selected"),jQuery(this).hasClass("selected")?jQuery(this).find("i.fa").removeClass("fa-square-o").addClass("fa-check-square-o"):jQuery(this).find("i.fa").removeClass("fa-check-square-o").addClass("fa-square-o")})}}),Promise.resolve()}).catch(function(e){return Promise.reject(e)})}function workWithSessionStorageMetaData(){var e=["Select","id","fullName","fileName","lastModifiedDate","lastModifiedByName","createdDate","createdByName"],a="2015-12-10";return""!=jQuery("#dateField").val()&&(a=new Date(jQuery("#dateField").val())),requestMetadata.forEach(function(t){var r=JSON.parse(sessionStorage.getItem(t.type));if(r&&r.length>0){var i,d;d=createTable(e,t.table);var s=!1;r.forEach(function(t){"installed"!=t.manageableState&&(""==a||a<new Date(t[filterByMetadata]))&&(addRow(t,e,jQuery(d).find("tbody")),s=!0)}),s&&(i=createPanel(t.type,d,jQuery("#container-tab2")),jQuery("#container").append(jQuery(i)),jQuery("#"+t.table).DataTable({order:[[e.indexOf("lastModifiedDate"),"desc"]],iDisplayLength:100}),jQuery("#"+t.table+" tbody").on("click","tr",function(){jQuery(this).toggleClass("selected"),jQuery(this).hasClass("selected")?jQuery(this).find("i.fa").removeClass("fa-square-o").addClass("fa-check-square-o"):jQuery(this).find("i.fa").removeClass("fa-check-square-o").addClass("fa-square-o")}))}}),Promise.resolve()}function workWithMetaData(){var e=["Select","id","fullName","fileName","lastModifiedDate","lastModifiedByName","createdDate","createdByName"],a="2015-12-10";""!=jQuery("#dateField").val()&&(a=new Date(jQuery("#dateField").val()));var t=requestMetadata.map(function(e){var a=[{type:e.type}];return sforce.metadata.list(a,apiVersion)});return Promise.all(t).then(function(t){return t.forEach(function(t,r){if(t&&t.length>0){var i,d;sessionStorage.setItem(requestMetadata[r].type,JSON.stringify(t)),d=createTable(e,requestMetadata[r].table);var s=!1;t.forEach(function(t){"installed"!=t.manageableState&&(""==a||a<new Date(t[filterByMetadata]))&&(addRow(t,e,jQuery(d).find("tbody")),s=!0)}),s&&(i=createPanel(requestMetadata[r].type,d,jQuery("#container-tab2")),jQuery("#container").append(jQuery(i)),jQuery("#"+requestMetadata[r].table).DataTable({order:[[e.indexOf("lastModifiedDate"),"desc"]],iDisplayLength:100}),jQuery("#"+requestMetadata[r].table+" tbody").on("click","tr",function(){jQuery(this).toggleClass("selected"),jQuery(this).hasClass("selected")?jQuery(this).find("i.fa").removeClass("fa-square-o").addClass("fa-check-square-o"):jQuery(this).find("i.fa").removeClass("fa-check-square-o").addClass("fa-square-o")}))}else sessionStorage.removeItem(requestMetadata[r].type)}),Promise.resolve()}).catch(function(e){return Promise.reject(e)})}function convertDate(e){if(void 0!==e){var a=new Date(e),t=a.getFullYear(),r=a.getMonth()+1,i=a.getDate();return r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i+"T00:00:00Z"}return""}function showLoading(){jQuery("#status").hasClass("show")||(jQuery("#status").addClass("show"),jQuery("#status").show(),jQuery("#preloader").show())}function hideLoading(){jQuery("#status").removeClass("show"),jQuery("#status").hide(),jQuery("#preloader").hide()}jQuery(function(){showLoading(),jQuery("#dateField").val(showDate((new Date).add(-1).month())),sforce.metadata.describe(apiVersion).then(function(e){return e.metadataObjects.forEach(function(e){e.childXmlNames&&e.childXmlNames.forEach(function(e){0==requestSqlData.filter(function(a){return a.type.toLowerCase()===e.toLowerCase()}).length&&requestMetadata.push({type:e,table:e+"_tb",apiFieldIndex:2})}),0==requestSqlData.filter(function(a){return a.type.toLowerCase()===e.xmlName.toLowerCase()}).length&&requestMetadata.push({type:e.xmlName,table:e.xmlName+"_tb",apiFieldIndex:2})}),requestMetadata=requestMetadata.sort(function(e,a){return e.type<a.type?-1:e.type>a.type?1:0}),workWithSOQL()}).then(function(){return workWithMetaData()}).then(function(){jQuery('#myTab a[href="#'+requestSqlData[0].type+'_tb-tab"]').tab("show"),hideLoading()}).catch(function(e){}),jQuery("#dateField").datepicker({format:"yyyy-mm-dd"})});
//# sourceMappingURL=app.min.js.map
